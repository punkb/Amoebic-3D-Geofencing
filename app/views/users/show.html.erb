
<head>
<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>
</head>

<h3>Event Details</h3>
  <h4>Event Name:</h4>
  <%= @currentEvent %></br>
  <h4>Event Coordinates </h4>
  <%= @currentEventCoord %>
</br>



<% @audiance = @present.map{|d| d.reverse}%>
<% @audiance = @audiance.map{|lat, long, infowindow| {lat: lat, lng: long, infowindow: ([lat, long]).to_s} }%>

<div style='width: 800px;'>
  <div id="multi_overlays" style='width: 1200px; height: 600px;'></div>
</div>

<script type="text/javascript">
// var myData = <%= raw json_escape(@fakeData.to_json) %>;
var myData = <%= @c.to_json.html_safe %>
var innerData = <%= @innerPolygon.to_json.html_safe %>
var outerData = <%= @outterPolygon.to_json.html_safe %>
var audianceData = <%= @audiance.to_json.html_safe %>


  var handler = Gmaps.build('Google');
handler.buildMap({ internal: {id: 'multi_overlays'}}, function(){


  var innerpolygons = handler.addPolygons(
    [
    innerData
    ],
    { strokeColor: '#FF0000'}
  );

  var outerpolygons = handler.addPolygons(
    [
    outerData
    ],
    { strokeColor: '#FF0000'}
  );

  var markers = handler.addMarkers(
    audianceData

    );
  handler.bounds.extendWith(markers);
   
   handler.bounds.extendWith(innerpolygons);
   handler.bounds.extendWith(outerpolygons);
  
  handler.fitMapToBounds();
  handler.getMap().setZoom(17);
});
</script>

<h4>Audience</h4>
<%= @audiance %>

<h4>Inner Polygon</h4>
<%= @innerPolygon %>

<h4>Outer Polygon</h4>
<%= @outterPolygon %>














