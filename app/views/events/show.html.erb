<head>
<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>
</head>

<p id="notice"><%= notice %></p>

<%= @msg %>

<p>
  <strong>Name:</strong>
  <%= @event.name %>
</p>

<p>
  <strong>Address:</strong>
  <%= @event.address %>
</p>


<%= link_to 'Edit', edit_event_path(@event) %> |
<%= link_to 'Back', events_path %>


<!-- 
<% @audiance = @bsonPresentHash.map{|lat, long, alt| {lat: lat, lng: long, infowindow: alt } }%>

 -->
<!-- 
<% @audiance = @present.map{|d| d.reverse}%>
<% @audiance = @audiance.map{|lat, long, infowindow| {lat: lat, lng: long, infowindow: ([lat, long]).to_s} }%>
 -->
<div style='width: 800px;'>
  <div id="multi_overlays" style='width: 800px; height: 400px;'></div>
</div>

<script type="text/javascript">
var audianceData = <%= @audiance.to_json.html_safe %>
var data = <%= @polygons.to_json.html_safe %>
var handler = Gmaps.build('Google');

handler.buildMap({ internal: {id: 'multi_overlays'}}, function(){	

for (i = 0; i < data.length; i++){
	var polygonGeofence = handler.addPolygons(
		[
			data[i]
		]
	);
	 

}
 
var markers = handler.addMarkers(audianceData);
  
handler.bounds.extendWith(markers);
  
handler.bounds.extendWith(polygonGeofence);
  
 
  handler.fitMapToBounds();
  handler.getMap().setZoom(18);
});

</script>

